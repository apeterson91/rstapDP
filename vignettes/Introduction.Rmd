---
title: "Introduction"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = TRUE
)
```

```{r setup}
library(rstapDP)
data("ClusterScales_two")
data("ClusterScales_two_ddata")
```



```{r fit}
knts <- quantile(ClusterScales_two_ddata$Distance,c(0.25,0.5,0.75))
fit <- fdp_staplm(BMI ~ sex,
                  knots = knts,
                  subject_data = ClusterScales_two %>% dplyr::mutate(simple=simple/max(simple)),
                  dt_data = ClusterScales_two_ddata,
                  alpha_a = 15, 
                  alpha_b = 15,
                  tau_df = 5,
                  K = 10,
                  iter_max = 2E4,
                  burn_in = 1.5E4,
                  thin = 2,
                  seed = 43431)
```



```{r pair_plot}
plot_pairs(fit)
```




```{r samples_plot}
plotpars(fit)
```




```{r,ppc}
ppc(fit)
```

## Smooth Scales


```{r}
fit <- fdp_staplm(BMI ~ sex,
                  knots = knts,
                  subject_data = ClusterScales_two %>% dplyr::mutate(simple=simple/max(simple)),
                  dt_data = ClusterScales_two_ddata,
                  alpha_a = 15, 
                  alpha_b = 15,
                  tau_df = 5,
                  K = 10,
                  iter_max = 2E4,
                  burn_in = 1.5E4,
                  thin = 2,
                  seed = 43431)
```
